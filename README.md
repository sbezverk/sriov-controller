# SRIOV controller

State: WIP

SRIOV controller is a daemonset which parsing host's SRIOV VF information 
from sriov config map and advertises it to kubelet via Device plugin API. Once SRIOV
network service information is advertised to kubelet, POD can request SRIOV network services.

Configmap is generated by nsm-sriov-config-manager.

Here is example of generated config map:

```yaml
apiVersion: v1
data:
  0000-81-10.0: |
    NetworkService: networkservicemesh.io/sriov-nsm-default
    parentDevice: enp129s0f0
    vfLocalID: 0
    vfioDevice: /dev/vfio/92
  0000-81-10.1: |
    NetworkService: networkservicemesh.io/sriov-nsm-default
    parentDevice: enp129s0f1
    vfLocalID: 0
    vfioDevice: /dev/vfio/100
  0000-81-10.2: |
    NetworkService: networkservicemesh.io/sriov-nsm-default
    parentDevice: enp129s0f0
    vfLocalID: 1
    vfioDevice: /dev/vfio/93
  0000-81-10.3: |
    NetworkService: networkservicemesh.io/sriov-ns-1
    parentDevice: enp129s0f1
    vfLocalID: 1
    vfioDevice: /dev/vfio/101
  0000-81-10.4: |
    NetworkService: networkservicemesh.io/sriov-ns-1
    parentDevice: enp129s0f0
    vfLocalID: 2
    vfioDevice: /dev/vfio/94
  0000-81-10.5: |
    NetworkService: networkservicemesh.io/sriov-ns-1
    parentDevice: enp129s0f1
    vfLocalID: 2
    vfioDevice: /dev/vfio/102
  0000-81-10.6: |
    NetworkService: networkservicemesh.io/sriov-ns-2
    parentDevice: enp129s0f0
    vfLocalID: 3
    vfioDevice: /dev/vfio/95
  0000-81-10.7: |
    NetworkService: networkservicemesh.io/sriov-ns-2
    parentDevice: enp129s0f1
    vfLocalID: 3
    vfioDevice: /dev/vfio/103
  0000-81-11.0: |
    NetworkService: networkservicemesh.io/sriov-ns-2
    parentDevice: enp129s0f0
    vfLocalID: 4
    vfioDevice: /dev/vfio/96
  0000-81-11.1: |
    NetworkService: networkservicemesh.io/sriov-ns-3
    parentDevice: enp129s0f1
    vfLocalID: 4
    vfioDevice: /dev/vfio/104
  0000-81-11.2: |
    NetworkService: networkservicemesh.io/sriov-ns-3
    parentDevice: enp129s0f0
    vfLocalID: 5
    vfioDevice: /dev/vfio/97
  0000-81-11.3: |
    NetworkService: networkservicemesh.io/sriov-ns-3
    parentDevice: enp129s0f1
    vfLocalID: 5
    vfioDevice: /dev/vfio/105
  0000-81-11.4: |
    NetworkService: networkservicemesh.io/sriov-ns-4
    parentDevice: enp129s0f0
    vfLocalID: 6
    vfioDevice: /dev/vfio/98
  0000-81-11.5: |
    NetworkService: networkservicemesh.io/sriov-ns-4
    parentDevice: enp129s0f1
    vfLocalID: 6
    vfioDevice: /dev/vfio/106
  0000-81-11.6: |
    NetworkService: networkservicemesh.io/sriov-ns-4
    parentDevice: enp129s0f0
    vfLocalID: 7
    vfioDevice: /dev/vfio/99
  0000-81-11.7: |
    NetworkService: networkservicemesh.io/sriov-ns-5
    parentDevice: enp129s0f1
    vfLocalID: 7
    vfioDevice: /dev/vfio/107
kind: ConfigMap
metadata:
  labels:
    networkservicemesh.io/sriov: ""
  name: nsm-sriov-vf-list
  namespace: default
```